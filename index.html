
<!doctype html>
<html>
  <head>
    <link href="images/favicon.ico" rel="icon" type="image/ico" />
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Accellion API Guide</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;php&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#quickstart" class="toc-h1 toc-link" data-title="Quickstart">Quickstart</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#prerequisites" class="toc-h2 toc-link" data-title="Prerequisites">Prerequisites</a>
                  </li>
                  <li>
                    <a href="#get-an-accellion-instance" class="toc-h2 toc-link" data-title="Get an Accellion instance">Get an Accellion instance</a>
                  </li>
                  <li>
                    <a href="#setup-your-first-custom-app" class="toc-h2 toc-link" data-title="Setup your first custom app">Setup your first custom app</a>
                  </li>
                  <li>
                    <a href="#setup-the-playground" class="toc-h2 toc-link" data-title="Setup the playground">Setup the playground</a>
                  </li>
                  <li>
                    <a href="#get-a-token" class="toc-h2 toc-link" data-title="Get a token">Get a token</a>
                  </li>
                  <li>
                    <a href="#call-an-endpoint" class="toc-h2 toc-link" data-title="Call an endpoint">Call an endpoint</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#signature-authorization-flow" class="toc-h2 toc-link" data-title="Signature Authorization flow">Signature Authorization flow</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#common-use-cases" class="toc-h1 toc-link" data-title="Common Use Cases">Common Use Cases</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#list-folder-contents" class="toc-h2 toc-link" data-title="List folder contents">List folder contents</a>
                  </li>
                  <li>
                    <a href="#download-file" class="toc-h2 toc-link" data-title="Download file">Download file</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#help" class="toc-h1 toc-link" data-title="Help">Help</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://info.accellion.com/demo-request?ref=api-guide-nav'>GET A DEMO</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to Accellion&#39;s API Guide.</p>

<p>Our RESTful Enterprise API enables you to quickly develop apps that leverage the power of the Accellion Platform. Developers can build custom apps tailored to specific industry and business use cases, as well as integrate with existing IT infrastructure.</p>

<p>We have sample code available in PHP. Over time, we will add sample code in other languages. You can view code samples in the dark area to the right.</p>
<h1 id='quickstart'>Quickstart</h1><h2 id='prerequisites'>Prerequisites</h2>
<p>You should be an experienced developer and have an understanding of the following concepts and technologies:</p>

<ul>
<li>OAuth 2.0</li>
<li>JSON data format</li>
<li>HTTP methods and status codes</li>
<li>REST APIs</li>
</ul>
<h2 id='get-an-accellion-instance'>Get an Accellion instance</h2>
<p>You will need an Accellion instance to get access to the API. If you don&#39;t already have one, please click on the button below:</p>

<p><a href="https://info.accellion.com/demo-request?ref=api-guide-setup" target="_blank"><img src="images/get-a-demo.png" alt="drawing" width="90px"/></a></p>
<h2 id='setup-your-first-custom-app'>Setup your first custom app</h2>
<p>If you already have an Accellion instance:</p>

<ol>
<li>Sign in to the Admin interface at https://[hostname]/admin. Replace [hostname] with your Accellion instance hostname.</li>
<li>Click on the Application tab icon using the top navigation bar.</li>
<li>Click on Client Management in the left navigation panel. <strong>NOTE</strong>: If you see the Custom Applications section under Client Management, you have everything you need to get started. Otherwise, please email <a href="mailto:support@accellion.com">support@accellion.com</a> to request API access for your instance.</li>
<li>Click on Custom Applications under Client Management.</li>
<li>Click on the + button to add your custom app. Further steps below the screenshot.
<img src="images/navigation-custom-apps.png" alt="Navigation custom apps" /></li>
<li>Fill up the Add Custom Application form as per your needs. Our example app will use standard OAuth 2.0 Authorization Code flow with refresh token. <strong>NOTE</strong>: If you want to test this app in the playground, set the Redirect URI to https://%%HOST%%/rest/callback.html. After testing, this should be changed to your app&#39;s own redirect URI.
<img src="images/custom-app-form.png" alt="Custom app form" /></li>
<li>Click on the Add Application button.</li>
<li>Copy and save the Client Application ID and Client Secret Key from the popup to a secure location. <strong>NOTE</strong>: This is your only chance to copy the secret key.</li>
<li>Click OK. Your custom application is now created and you are ready to start experimenting in the playground.</li>
</ol>
<h2 id='setup-the-playground'>Setup the playground</h2>
<ol>
<li>On the Custom Applications page in Admin interface, turn the API playground ON. Click OK in the confirmation popup.</li>
<li>Click the &quot;?&quot; icon near the top right.</li>
<li>Click &quot;Developer Documentation&quot;. This should open the playground in a new tab.
<img src="images/playground-setup.png" alt="Playground setup" /></li>
</ol>
<h2 id='get-a-token'>Get a token</h2>
<ol>
<li>Once the playground has loaded (resource list has been fetched), click the &quot;Get a token&quot; button near the top right.</li>
<li>In the popup form, Authorization Code grant type is selected by default. Enter the Client App ID and Client App Secret Key of the custom app you created in the previous section.</li>
<li>Click &quot;Authorize and Get Token&quot;.
<img src="images/playground-get-token.png" alt="Playground get token" /></li>
<li>Click &quot;Grant Access&quot; in the new End-User Authorization popup. The playground will receive a token from the Accellion server and display it in the top right. You are now ready to make your first API call from the playground.</li>
</ol>
<h2 id='call-an-endpoint'>Call an endpoint</h2>
<p>Now that the playground has the access token, it is time to perform a basic API call.</p>

<p>On the playground webpage, you will see several categories like activities, admin, etc. Clicking on a category name expands it, showing all the endpoints in it. The categories are arranged alphabetically.</p>

<p>Scroll down and click the <strong>users</strong> category.</p>

<p><img src="images/users.png" alt="Users" /></p>

<p>The endpoints are color coded based on the HTTP method. To the right of each endpoint, there is a brief description of its purpose.</p>

<p>Click on the endpoint <strong>GET /rest/users/me</strong> to see more details about it.</p>

<p><img src="images/getrestusersme.png" alt="Getrestusersme" /></p>

<p>Click the <strong>Try it out!</strong> button. In the <strong>Response Body</strong> section, you will see a JSON object of the <strong>users</strong> class, and it will contain the current user&#39;s information.</p>

<p><img src="images/tryitout.png" alt="Tryitout" /></p>
<h1 id='authentication'>Authentication</h1><h2 id='signature-authorization-flow'>Signature Authorization flow</h2>
<p>Accellion offers Signature Authorization flow for <strong>trusted</strong> apps where user interaction is impossible or undesirable. This is mostly applicable when some backend servers in your corporate network need to communicate with Accellion or when your app handles user authentication on its own.</p>

<aside class="warning">
Apps using Signature Authorization flow can access any user's content, simply by specifying their email address. As such, these apps should only be accessible by trusted employees with high security clearance.
</aside>
<pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>

<span class="c1">// --- Configuration Section ---
</span><span class="nv">$kiteworks_hostname</span>     <span class="o">=</span> <span class="s1">'YOUR-SERVER.DOMAIN.ORG'</span><span class="p">;</span>
<span class="nv">$client_app_id</span>          <span class="o">=</span> <span class="s1">'YOUR-CLIENT-APP-ID'</span><span class="p">;</span>
<span class="nv">$client_app_secret_key</span>  <span class="o">=</span> <span class="s1">'YOUR-CLIENT-APP-SECRET-KEY'</span><span class="p">;</span>
<span class="nv">$signature_key</span>          <span class="o">=</span> <span class="s1">'YOUR-SIGNATURE-KEY'</span><span class="p">;</span>
<span class="nv">$user_id</span>                <span class="o">=</span> <span class="s1">'YOUR-USER-EMAIL-TO-BE-USED-FOR-API-INTEGRATION'</span><span class="p">;</span>
<span class="nv">$api_scope</span>              <span class="o">=</span> <span class="s1">'YOUR-CLIENT-APP-SCOPES'</span><span class="p">;</span> <span class="c1">// e.g. 'folders/* files/* mail/*'
</span><span class="nv">$redirect_uri</span>           <span class="o">=</span> <span class="s1">'YOUR-REDIRECT-URI'</span><span class="p">;</span>

<span class="c1">// --- Generate Signature Based Auth Code ---
</span><span class="nv">$timestamp</span>              <span class="o">=</span> <span class="nb">time</span><span class="p">();</span>
<span class="nv">$nonce</span>                  <span class="o">=</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">999999</span><span class="p">);</span>

<span class="nv">$base_string</span> <span class="o">=</span> <span class="s2">"</span><span class="nv">$client_app_id</span><span class="s2">|@@|</span><span class="nv">$user_id</span><span class="s2">|@@|</span><span class="nv">$timestamp</span><span class="s2">|@@|</span><span class="nv">$nonce</span><span class="s2">"</span><span class="p">;</span>
<span class="nv">$signature</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s2">"sha1"</span><span class="p">,</span><span class="nv">$base_string</span><span class="p">,</span> <span class="nv">$signature_key</span><span class="p">);</span>
<span class="nv">$auth_code</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$client_app_id</span><span class="p">)</span><span class="o">.</span><span class="s2">"|@@|"</span><span class="o">.</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$user_id</span><span class="p">)</span><span class="o">.</span><span class="s2">"|@@|</span><span class="nv">$timestamp</span><span class="s2">|@@|</span><span class="nv">$nonce</span><span class="s2">|@@|</span><span class="nv">$signature</span><span class="s2">"</span><span class="p">;</span>


<span class="c1">// --- Initialize CURL Parameters Section ---
</span><span class="nv">$access_token_endpoint</span> <span class="o">=</span> <span class="s2">"https://</span><span class="nv">$kiteworks_hostname</span><span class="s2">/oauth/token"</span><span class="p">;</span>

<span class="nv">$postData</span>  <span class="o">=</span> <span class="s2">"client_id="</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$client_app_id</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"&amp;"</span><span class="p">;</span> 
<span class="nv">$postData</span> <span class="o">.=</span> <span class="s2">"client_secret="</span><span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$client_app_secret_key</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"&amp;"</span><span class="p">;</span> 
<span class="nv">$postData</span> <span class="o">.=</span> <span class="s2">"grant_type=authorization_code&amp;"</span><span class="p">;</span> 
<span class="nv">$postData</span> <span class="o">.=</span> <span class="s2">"code="</span><span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$auth_code</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"&amp;"</span><span class="p">;</span>
<span class="nv">$postData</span> <span class="o">.=</span> <span class="s2">"scope="</span><span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$api_scope</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"&amp;"</span><span class="p">;</span>
<span class="nv">$postData</span> <span class="o">.=</span> <span class="s2">"redirect_uri="</span><span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$redirect_uri</span><span class="p">);</span> 


<span class="c1">// --- Make CURL request ---
</span><span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$access_token_endpoint</span><span class="p">);</span>       
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POST</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$postData</span> <span class="p">);</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span> <span class="nv">$ch</span> <span class="p">);</span>
<span class="nv">$curl_error</span> <span class="o">=</span> <span class="nb">curl_error</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nv">$error_no</span> <span class="o">=</span> <span class="nb">curl_errno</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
<span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>

<span class="c1">// --- Print Response ---
</span><span class="k">if</span> <span class="p">(</span><span class="nv">$curl_error</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">print</span> <span class="s2">"Curl error </span><span class="nv">$error_no</span><span class="s2">: "</span> <span class="o">.</span> <span class="nv">$curl_error</span><span class="o">.</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
  <span class="k">die</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
  <span class="nv">$arr_response</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$response</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="nb">print_r</span><span class="p">(</span><span class="nv">$arr_response</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre><h3 id='steps-in-signature-flow'>Steps in Signature flow</h3>
<ol>
<li>Calculate authorization code using the following parameters:

<ul>
<li>Signature Key and Client ID: These were displayed on the Admin interface when the custom app using Signature flow was created.</li>
<li>Email address of the user for whom the app needs an access token.</li>
<li>Current timestamp: The code will remain valid for an hour after creation.</li>
<li>Nonce: A random integer between 1 and 999999.</li>
</ul></li>
<li>Fetch access token from Accellion&#39;s token URI using the following parameters:

<ul>
<li>Client ID and secret: Displayed on Admin interface when app was created.</li>
<li>Grant Type: This should be the string “authorization_code” for the token request to work.</li>
<li>Scope: This is the scope of the API services that the client application wants to access. This should be a space-separated string that consists of the name of the services that the application requires. The requested scope must be a subset of the client application’s registered scope in the server.</li>
<li>Redirect URL: This is exactly the same redirect URI as registered with the server.</li>
<li>Code: This is the authorization code calculated in step one.</li>
</ul></li>
</ol>

<aside class="notice">
Note that the step 2 is the same as OAuth 2.0 Authorization Code flow. Step 1 <b>calculates</b> the auth code instead of asking the user and Accellion server for it. This is what gives Signature Flow its power and risks.
</aside>
<h3 id='responses-from-server'>Responses from server</h3>
<p>Once these two steps are complete, if there are no errors for the POST request, the server will return a HTTP response 200 OK. The body for the response will be in JSON format and will include the following:</p>

<ul>
<li>  <strong>access_token:</strong> This is the token that will be used for all requests to the API.</li>
<li>  <strong>expires_in:</strong> This is the number of seconds after which the access token will expire.</li>
<li>  <strong>scope:</strong> This is the scope for which this token is valid.</li>
<li>  <strong>refresh_token:</strong> This is a token that can be used to get a new access token without going through the first step of authorization.</li>
<li>  <strong>token_type:</strong> This will be set to “bearer” because that is the type of token.</li>
</ul>

<p>If there are problems with the request, the server will return a HTTP 400 bad request. The body of the response will contain error information in JSON format. Here are the possible values for the error code:</p>

<ul>
<li>  <strong>invalid_client:</strong> This indicates that the client application authentication failed. This is likely because either the client ID and/or the secret key provided are incorrect.</li>
<li>  <strong>invalid_grant:</strong> This indicates that the user’s credentials are not valid.</li>
<li>  <strong>invalid_scope:</strong> This indicates that the requested scope in invalid or exceeds the previously granted scope.</li>
<li>  <strong>invalid_request:</strong> This indicates that the request is malformed, which usually means that there is a missing parameter that is required.</li>
<li>  <strong>unauthorized_client:</strong> This indicates that the client application is not authorized to use this flow.</li>
</ul>
<h1 id='common-use-cases'>Common Use Cases</h1><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="c1">// --- Generic helper function to make CURL calls based on the protocol --- 
</span>
<span class="k">function</span> <span class="nf">jsonCurl</span><span class="p">(</span><span class="nv">$url</span><span class="p">,</span> <span class="nv">$json_data</span><span class="p">,</span> <span class="nv">$arr_params</span> <span class="o">=</span> <span class="k">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$ch</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">();</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span><span class="nx">CURLOPT_URL</span><span class="p">,</span> <span class="nv">$url</span><span class="p">);</span>
    <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="c1">// Do not add POSTFIELDS for a GET request
</span>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nv">$arr_params</span> <span class="o">&amp;&amp;</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s1">'protocol'</span><span class="p">,</span> <span class="nv">$arr_params</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nv">$arr_params</span><span class="p">[</span><span class="s1">'protocol'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'get'</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$json_data</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$arr_params</span> <span class="o">&amp;&amp;</span> <span class="nb">array_key_exists</span><span class="p">(</span><span class="s1">'header'</span><span class="p">,</span> <span class="nv">$arr_params</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="nv">$arr_params</span><span class="p">[</span><span class="s1">'header'</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s2">"Content-type: application/json"</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="nv">$error</span> <span class="o">=</span> <span class="nb">curl_error</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="nv">$curl_http_code</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$ch</span><span class="p">,</span> <span class="nx">CURLINFO_HTTP_CODE</span><span class="p">);</span>
    <span class="nb">curl_close</span><span class="p">(</span><span class="nv">$ch</span><span class="p">);</span>
    <span class="nv">$arr_response</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
    <span class="nv">$arr_response</span><span class="p">[</span><span class="s1">'response'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$response</span><span class="p">);</span>
    <span class="nv">$arr_response</span><span class="p">[</span><span class="s1">'error'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="nv">$error</span><span class="p">);</span>
    <span class="nv">$arr_response</span><span class="p">[</span><span class="s1">'curl_http_code'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$curl_http_code</span><span class="p">;</span>
    <span class="k">return</span> <span class="nv">$arr_response</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>The following examples make use of the access token received in the <a href="#authentication">Authentication</a> section above to interact with the server.</p>

<p>On the right, we have a helper function that makes the actual HTTP call to the Accellion server. It takes in the endpoint URL, input data in the form of JSON and HTTP parameters in an array.</p>

<p>This function will be used in the following code samples for different use cases.</p>
<h2 id='list-folder-contents'>List folder contents</h2><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'CONST_EAPI_VERSION'</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>   <span class="c1">// Put the latest API version in place of 9
</span>
<span class="nv">$oAuthToken</span> <span class="o">=</span> <span class="s2">"GET-OAUTH-TOKEN"</span><span class="p">;</span>    <span class="c1">// Use the code in getOAuthToken.php to get the token
</span>
<span class="c1">// --- Configuration Section ---
</span><span class="nv">$folderId</span>           <span class="o">=</span> <span class="s1">'YOUR-FOLDER-ID'</span><span class="p">;</span>
<span class="nv">$kiteworks_hostname</span> <span class="o">=</span> <span class="s1">'YOUR-SERVER.DOMAIN.ORG'</span><span class="p">;</span>

<span class="nv">$api_end_point</span> <span class="o">=</span> <span class="s2">"https://</span><span class="nv">$kiteworks_hostname</span><span class="s2">/rest/folders/</span><span class="nv">$folderId</span><span class="s2">/children?deleted=false"</span><span class="p">;</span>
<span class="nv">$headers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"Content-Type: application/json"</span><span class="p">,</span>
            <span class="s2">"Accept: application/json"</span><span class="p">,</span>
            <span class="s2">"X-Accellion-Version: "</span> <span class="o">.</span> <span class="nx">CONST_EAPI_VERSION</span><span class="p">,</span>
            <span class="s2">"Authorization: Bearer </span><span class="nv">$oAuthToken</span><span class="s2">"</span> <span class="p">);</span>

<span class="c1">// --- Passing additional information about protocol and headers to the generic helper function --- 
</span><span class="nv">$arr_params</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nv">$arr_params</span><span class="p">[</span><span class="s1">'header'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$headers</span><span class="p">;</span>
<span class="nv">$arr_params</span><span class="p">[</span><span class="s1">'protocol'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'get'</span><span class="p">;</span>

<span class="nv">$postData</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>    <span class="c1">//  API uses GET protocol. Does not require POST data. Initializing for the generic helper function
</span><span class="nv">$arr_capi_response</span> <span class="o">=</span> <span class="nx">jsonCurl</span><span class="p">(</span><span class="nv">$api_end_point</span><span class="p">,</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$postData</span><span class="p">),</span> <span class="nv">$arr_params</span><span class="p">);</span>
<span class="nb">print_r</span><span class="p">(</span><span class="nv">$arr_capi_response</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>In <a href="#call-an-endpoint">Call an endpoint</a> section above, you called <strong>GET /rest/users/me</strong> to retrieve basic information about the current user (yourself). One of the attributes returned was &quot;syncdirId&quot;, which refers to your automatically created default &quot;My Folder&quot;.</p>

<p>In this section, you will use the <strong>GET /rest/folders/{folder ID}/children</strong> endpoint to get the list of items (files and sub-folders) inside this folder.</p>

<p>In the code sample on the right, replace &quot;YOUR-FOLDER-ID&quot; with the value of &quot;syncdirId&quot; (or the ID of any other folder you have access to). Also, replace &quot;GET-OAUTH-TOKEN&quot; with the access token retrieved in the <a href="#authentication">Authentication</a> section, and &quot;YOUR-SERVER.DOMAIN.ORG&quot; with the hostname of your Accellion server.</p>

<p>Then, copy and paste the script on a machine that has PHP installed and run it. You will see the server response with the contents of your My Folder in JSON format.</p>
<h2 id='download-file'>Download file</h2><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">'CONST_EAPI_VERSION'</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>    <span class="c1">// Put the latest API version in place of 9
</span>
<span class="nv">$oAuthToken</span> <span class="o">=</span> <span class="s2">"GET-OAUTH-TOKEN"</span><span class="p">;</span>    <span class="c1">// Use the code in getOAuthToken.php to get the token
</span>
<span class="c1">// --- Configuration Section ---
</span><span class="nv">$fileId</span>           <span class="o">=</span> <span class="s1">'YOUR-FILE-ID'</span><span class="p">;</span>
<span class="nv">$kiteworks_hostname</span> <span class="o">=</span> <span class="s1">'YOUR-SERVER.DOMAIN.ORG'</span><span class="p">;</span>

<span class="nv">$api_end_point</span> <span class="o">=</span> <span class="s2">"https://</span><span class="nv">$kiteworks_hostname</span><span class="s2">/rest/files/</span><span class="nv">$fileId</span><span class="s2">/content"</span><span class="p">;</span>
<span class="nv">$headers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"Content-Type: application/json"</span><span class="p">,</span>
            <span class="s2">"Accept: application/json"</span><span class="p">,</span>
            <span class="s2">"X-Accellion-Version: "</span> <span class="o">.</span> <span class="nx">CONST_EAPI_VERSION</span><span class="p">,</span>
            <span class="s2">"Authorization: Bearer </span><span class="nv">$oAuthToken</span><span class="s2">"</span> <span class="p">);</span>

<span class="c1">// --- Passing additional information about protocol and headers to the generic helper function --- 
</span><span class="nv">$arr_params</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nv">$arr_params</span><span class="p">[</span><span class="s1">'header'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$headers</span><span class="p">;</span>
<span class="nv">$arr_params</span><span class="p">[</span><span class="s1">'protocol'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'get'</span><span class="p">;</span>

<span class="nv">$postData</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>    <span class="c1">//  API uses GET protocol. Does not require POST data. Initializing for the generic helper function
</span><span class="nv">$arr_capi_response</span> <span class="o">=</span> <span class="nx">jsonCurl</span><span class="p">(</span><span class="nv">$api_end_point</span><span class="p">,</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$postData</span><span class="p">),</span> <span class="nv">$arr_params</span><span class="p">);</span>
<span class="nb">print_r</span><span class="p">(</span><span class="nv">$arr_capi_response</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<p>Next, let&#39;s use the <strong>GET /rest/files/{file ID}/content</strong> endpoint to get the contents of a file.</p>

<p>In the code sample on the right, replace &quot;YOUR-FILE-ID&quot; with one of the file IDs returned in the folder listing response (or the ID of any other file you have access to). Also, replace &quot;GET-OAUTH-TOKEN&quot; with the access token retrieved in the <a href="#authentication">Authentication</a> section, and &quot;YOUR-SERVER.DOMAIN.ORG&quot; with the hostname of your Accellion server.</p>

<p>You will see the server response with the contents of your file in the &#39;response&#39; key.</p>
<h1 id='help'>Help</h1>
<p>Please tell us how we can improve this guide for you.</p>

<p>Perhaps you would like to see code samples in a different language or for a different use case. Or maybe you need help figuring out how to solve your business problem using Accellion&#39;s API.</p>

<p>Send us an email at <a href="mailto:support@accellion.com">support@accellion.com</a></p>

<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
